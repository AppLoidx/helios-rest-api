
## Moved to Spring Ver: https://github.com/AppLoidx/helios-rest-api-spring
<br>
<br>
<br>
<h1 align=center>Helios REST API side
<br>
  <img src="https://codecov.io/gh/AppLoidx/helios-rest-api/branch/master/graph/badge.svg" />
  <a href="https://travis-ci.org/AppLoidx/helios-rest-api"><img src="https://travis-ci.org/AppLoidx/helios-rest-api.svg?branch=master" /></a>
  <img src="https://img.shields.io/badge/Java-1.8-brightgreen" />
</h1>



## üôÇAuthor

**Arthur Kupriyanov**

- VK: [@apploidxxx](https://vk.com/apploidxxx)
- Github: [@AppLoidx](https://github.com/AppLoidx)
- Mail: [apploidyakutsk@gmail.com](apploidyakutsk@gmail.com)

# üìô–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∫ API Helios

<h2 align=center><img src="https://i.imgur.com/LCermq5.png" width=170 height=170 /></h2>

**API docs v1** : [–í–µ–±-–≤–µ—Ä—Å–∏—è](https://apploidx.github.io/helios-doc/) –∏–¥–µ–Ω—Ç–∏—á–Ω–∞—è —Å README.md

## –ó–∞–ø—É—Å–∫
–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å `hiberante.cfg.xml`
```
mvn install
java -jar target/fileName.jar
```
## –û–±—â–∏–µ —Å–≤–µ–¥–µ–Ω–∏—è
### –ü—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–≠—Ç–æ—Ç API –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–º –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤—Å–µ–º–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º–∏, –≤ —Ç–æ–º —á–∏—Å–ª–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Å–æ—Ü–∏–∞–ª—å–Ω—ã–º–∏ —Å–µ—Ç—è–º–∏ –∏ —Ç–æ–º—É –ø–æ–¥–æ–±–Ω—ã–º. –¢–∞–∫–∂–µ —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –æ–Ω –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –º–µ—Ç–æ–¥—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ –ø—Ä–æ—Ç–æ–∫–æ–ª OAuth.

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é API –∏ –ø—Ä–∏–º–µ—Ä—ã –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ [–∑–¥–µ—Å—å](https://apploidx.github.io/helios-doc/)

### –°—Ä–µ–¥—Å—Ç–≤–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω **JAX-RS** —á–µ—Ä–µ–∑ **Jersey** –∏ –ø–æ–¥–Ω—è—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ **GrizzlyHttpServer** –æ—Ç Apache. –ó–∞–¥–µ–ø–ª–æ–µ–Ω –≤ —Å–µ—Ä–≤–∏—Å–µ [heroku](https://heroku.com)

–°–±–æ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è —á–µ—Ä–µ–∑ **maven** —Å —Å–∏—Å—Ç–µ–º–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–±–æ—Ä–∫–∏ –Ω–∞ [travis-ci](https://travis-ci.org/AppLoidx/helios-rest-api)

## –ò–µ—Ä–∞—Ä—Ö–∏—è —Ñ–∞–π–ª–æ–≤
`com.apploidxxx` :
* `api` - –∫–ª–∞—Å—Å—ã –∏ –º–µ—Ç–æ–¥—ã –æ—Ç–≤–µ—á–∞—é—â–∏–µ –∑–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –∑–∞–ø—Ä–æ—Å–æ–≤
	* `exceptions` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
	* `filter` - —Ñ–∏–ª—å—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤
	* `model` - POJO –æ–±—ä–µ–∫—Ç—ã
* `ds` - —Å—Ä–µ–¥—Å—Ç–≤–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ datasource (HibernateSession)
* `entity` - —Ö—Ä–∞–Ω–∏–º—ã–µ –æ–±—ä–µ–∫—Ç—ã (persistence units)
	* `dao` - —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤—Å–µ—Ö DAO –∏ –∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

`test`:
* `api` - —Ç–µ—Å—Ç—ã –ø–æ API (–∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ rest-assured)
* `entity` - —Ç–µ—Å—Ç—ã –ø–æ –ª–æ–≥–∏–∫–µ —Ä–∞–±–æ—Ç—ã —Ö—Ä–∞–Ω–∏–º—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤

`resources/static`:
* `external` - —Ñ–æ—Ä–º—ã –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏\—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ OAuth

## api/exceptions
![](https://i.imgur.com/oGFyG4C.png) 
#### IResponsibleException
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤—Å–µ—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ–º—ã—Ö –≤ —Ä–∞–±–æ—Ç–µ —Å API –∏ –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å `Response` –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–ª–∏–µ–Ω—Ç—É. 
```java
import javax.ws.rs.core.Response;
public interface IResponsibleException {  
	  Response getResponse();  
	  String getErrorMessage();  
	  String getErrorDescription();  
}
```
#### ResponsibleException
- –ü—Ä–æ—Å–ª–æ–π–∫–∞ –º–µ–∂–¥—É –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º `IResponsibleException` –∏ —Å–∞–º–∏–º–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è–º–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä–∞—è –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç `Exception` –∏ —è–≤–ª—è–µ—Ç—Å—è –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω–æ–π:
```java
public abstract class ResponsibleException extends Exception implements IResponsibleException {  }
```
–ù–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –æ—Ç —ç—Ç–æ–≥–æ –∫–ª–∞—Å—Å–∞ (–µ–≥–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è `IResponsibleException`) –¥–∞–µ—Ç –Ω–∞–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å (–≤–º–µ—Å—Ç–µ —Å `try/catch` –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏) —Ç–∞–∫–æ–≥–æ –≤–∏–¥–∞ —É–ø—Ä–æ—â–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫:

_–õ–∏—Å—Ç–∏–Ω–≥ 1.1 QueueApi_
```java
public Response getQueue(   @Valid@NotNull@QueryParam("queue_name") String queueName){  
  
  try {  
	Queue q = QueueManager.getQueue(queueName);
	return Response.ok(q).build();  
  } catch (InvalidQueueException e) {  
        return e.getResponse();  
  }  
}
```
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –∏—Å–∫–ª—é—á–µ–Ω–∏–µ —É–º–µ–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å `Response`, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é. –í–æ—Ç –µ–≥–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:

_–õ–∏—Å—Ç–∏–Ω–≥ 1.2 InvalidQueueException_
```java
public class InvalidQueueException extends ResponsibleException{  
  
    @Override  
  public Response getResponse() {  
        return Response  
                .status(Response.Status.NOT_FOUND)  
                .entity(new ErrorMessage(getErrorMessage(), getErrorDescription()))  
                .build();  
  }  
  
    @Override  
  public String getErrorMessage() {  
        return "invalid_queue";  
  }  
  
    @Override  
  public String getErrorDescription() {  
        return "queue not found";  
  }  
}
```
## api/model
–ó–¥–µ—Å—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã POJO –æ–±—ä–µ–∫—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—é –¥–æ–ª–∂–Ω—ã —Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å—Å—è –≤ json. –í—Å–µ –∏–º–µ–Ω–∞ –ø–æ–ª–µ–π —è –±—É–¥—É –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫–∞–∫ –æ–Ω–∏ –Ω–∞–ø–∏—Å–∞–Ω—ã –≤ —Å–∞–º–æ–º –∫–æ–¥–µ (—Ç–æ –µ—Å—Ç—å –≤ –≤–µ—Ä–±–ª—é–∂–µ–º —Å—Ç–∏–ª–µ), –Ω–æ –≤—Å–µ –æ–Ω–∏ –ø—Ä–∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –º–µ–Ω—è—é—Ç —Å–≤–æ–π –ø—Ä–æ–ø–µ—Ä—Ç–∏ –Ω–∞ —Å—Ç–∏–ª—å json, —Ç–æ –µ—Å—Ç—å `this_is_my_value`
### ErrorMessage
–û–±—ä–µ–∫—Ç —è–≤–ª—è—é—â–∏–π—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç–≤–µ—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞–º, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–∑—ã–≤–∞–ª–∏ –æ—à–∏–±–∫—É –∏–ª–∏ –±—ã–ª–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã. –°–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª—è `error` –∏ `errorDescription`
### Check
–û–±—ä–µ–∫—Ç —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –ø–æ–ª–µ `exist`. –û–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è `CheckApi`, –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ç–∞–∫–æ–≥–æ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –æ—á–µ—Ä–µ–¥–∏.
### UserInfo
–ö–ª–∞—Å—Å-–≤—Ä–∞–ø–ø–µ—Ä –¥–ª—è —Å—É—â–Ω–æ—Å—Ç–∏ User. –í–æ—Ç –µ–≥–æ –ø–æ–ª—è:
```java
private User user;  
private List<String[]> queues; 
 
@JsonProperty("queues_member")    
private List<String[]> queuesMember;  

@JsonProperty("swap_requests")  
private List<Map<String, String>> swapRequests;
```
* **queues** - –∫–æ–ª–ª–µ–∫—Ü–∏—è –∏–∑ –º–∞—Å—Å–∏–≤–∞ –æ—á–µ—Ä–µ–¥–µ–π, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö –¥–≤–∞ –∑–Ω–∞—á–µ–Ω–∏—è - –∫–æ—Ä–æ—Ç–∫–æ–µ –∏–º—è (—Å—Å—ã–ª–∫–∞) –∏ –ø–æ–ª–Ω–æ–µ –∏–º—è –æ—á–µ—Ä–µ–¥–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, `{["shortLink","My Queue Fullname" ]}`. –≠—Ç–æ—Ç —Å–ø–∏—Å–æ–∫ —Å–æ–¥–µ—Ä–∂–∏—Ç –æ—á–µ—Ä–µ–¥–∏, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∫–∞–∫ —É—á–∞—Å—Ç–Ω–∏–∫ –∏–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä.
* **queuesMember** - —Ç–∞–∫–æ–π –∂–µ —Å–ø–∏—Å–æ–∫ –∫–∞–∫ `queues`, –Ω–æ —Å–æ–¥–µ—Ä–∂–∏—Ç –æ—á–µ—Ä–µ–¥–∏, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —è–≤–ª—è–µ—Ç—Å—è –ª–∏—à—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–º (–Ω–µ –≤—Ö–æ–¥—è—Ç –æ—á–µ—Ä–µ–¥–∏, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –æ–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)
* **user** - –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ, –∫—Ä–æ–º–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –∫–∞–∫ –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–∞—Ä–æ–ª—å
* **swapRequests** - —Å–ø–∏—Å–æ–∫ –º–∞–ø–æ–≤ –æ–ø–∏—Å—ã–≤–∞—é—â–∏—Ö –∑–∞—è–≤–∫–∏ –Ω–∞ –æ–±–º–µ–Ω –º–µ—Å—Ç–∞–º–∏ (–ø–æ–∫–∞ —Ç–æ–ª—å–∫–æ –∏—Å—Ö–æ–¥—è—â–∏—Ö). –ú–µ—Ç–æ–¥ –¥–æ–±–∞–≤–ª—è—é—â–∏–π –∑–Ω–∞—á–µ–Ω–∏–µ –≤ `swapRequest`:<br>
_–õ–∏—Å—Ç–∏–Ω–≥ 2.1 UserInfo_
	```java
	private void addSwapRequest(Queue queue, User user){  
	  SwapContainer sc = queue.getSwapContainer();  
	  User target = sc.getSwapRequest(user);  
	  if (target != null) {  
	          Map<String, String> hashMap = new HashMap<>();  
			  hashMap.put("queue_name", queue.getName());  
			  hashMap.put("queue_fullname", queue.getFullname());  
			  hashMap.put("target_username", target.getUsername());  
			  hashMap.put("target_firstname", target.getFirstName());  
			  hashMap.put("target_lastname", target.getLastName());  
			  swapRequests.add(hashMap);  
	  }  
	}
	```
## api/util

### ErrorResponseFactory
–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–∞ —Ñ–∞–±—Ä–∏–∫–∏ - –∏–º–µ–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–µ –æ–±—ä–µ–∫—Ç—ã `Response` —Å —Ç–µ–º –∏–ª–∏ –∏–Ω—ã–º –∫–æ–¥–æ–º –æ—à–∏–±–∫–∏ –∏ –∫–∞–∫ –≥–æ–≤–æ—Ä–∏–ª–æ—Å—å —Ä–∞–Ω–µ–µ, –æ–±—ä–µ–∫—Ç–æ–º `ErrorMessage` –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ—Ç–≤–µ—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é:

_–õ–∏—Å—Ç–∏–Ω–≥ 2.2 ErrorResponseFactory_
```java
public abstract class ErrorResponseFactory {  
    public static Response getInvalidParamErrorResponse(String description){  
        return Response  
                .status(Response.Status.BAD_REQUEST)  
                .entity(new ErrorMessage("invalid_param", description))  
                .build();  
  }  
  
    public static Response getForbiddenErrorResponse(String description){  
        return Response  
                .status(Response.Status.FORBIDDEN)  
                .entity(new ErrorMessage("insufficient_rights", description))  
                .build();  
  }  
  
    public static Response getForbiddenErrorResponse(){  
        return getForbiddenErrorResponse("You don't have enough rights");  
  }  
  ...
}
```

### Password
–ö–ª–∞—Å—Å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–∞—Ä–æ–ª–µ–π. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç MD5 —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ. –ò–º–µ–µ—Ç –¥–≤–∞ –ø—É–±–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–∞:

_–õ–∏—Å—Ç–∏–Ω–≥ 2.3 Password_
```java
public static String hash(String password){  
    return Md5Crypt.md5Crypt((password + salt).getBytes());  
}
public static boolean isEqual(String rawPassword, String hashedPassword){  
    return hashedPassword.equals(hash(rawPassword, hashedPassword));  
}
```
–°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, `hash` —Ö—ç—à–∏—Ä—É–µ—Ç –ø–∞—Ä–æ–ª—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î, –∞ `isEqual` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π.

### QueueManager, UserManager, UserSessionManager
–≠—Ç–æ –æ–±–µ—Ä—Ç–∫–∏ –Ω–∞–¥ `QueueService` –∏ `UserService`, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç —Å —Å—É—â–Ω–æ—Å—Ç—è–º–∏ –ë–î. –û–Ω–∏ –∏–º–µ—é—Ç –º–µ—Ç–æ–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –≤—ã–∫–∏–¥—ã–≤–∞—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, –∫–∞–∫ –Ω–∞–ø—Ä–∏–º–µ—Ä, `InvalidQueueException` –∏–ª–∏ `UserNotFoundException`.

_–õ–∏—Å—Ç–∏–Ω–≥ 2.4 QueueManager_
```java
public class QueueManager {  
  public  static Queue getQueue(String queueName) throws InvalidQueueException {  
      Queue q = QueueService.findQueue(queueName);  
	  if (q == null){  
	      throw new InvalidQueueException();  
	  } else {  
	      return q;  
	  }  
  }  
}
```

### VulnerabilityChecker
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç—Ä–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –∏ –Ω–∞–ª–∏—á–∏–µ –æ–ø–∞—Å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, —Ç–∞–∫–∏—Ö –∫–∞–∫ `<script>`. –ò–º–µ–µ—Ç –æ–¥–∏–Ω –º–µ—Ç–æ–¥ `checkWord`, –∫–æ—Ç–æ—Ä—ã–π –≤ —Å–ª—É—á–∞–µ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ `VulnerabilityException`.

## entity/dao

–í —ç—Ç–æ–º –ø–∞–∫–µ—Ç–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è DAO-–æ–±—ä–µ–∫—Ç—ã, –ø—Ä–∏ —ç—Ç–æ–º –∫–∞–∂–¥–æ–≥–æ —Ç–∞–∫–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –æ–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç—Å—è –ª–∏—à—å –ø–∞–∫–µ—Ç–æ–º, –∞ –ø—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø –¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∫–ª–∞—Å—Å (–ø–æ–¥—Ä–æ–±–Ω–µ–µ –¥–∞–ª–µ–µ)

### DAOBasicOperations
–ö–ª–∞—Å—Å –∫–æ—Ç–æ—Ä—ã–π —Ä–µ–∞–ª–∏–∑—É–µ—Ç –ø—Ä–æ—Å—Ç—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å —Å—É—â–Ω–æ—Å—Ç—è–º–∏ –∏ –ë–î, —á—Ç–æ–±—ã –Ω–µ –ø–∏—Å–∞—Ç—å –º–Ω–æ–≥–æ boilerplate-–∫–æ–¥–∞ –æ–Ω –±—ã–ª –≤—ã–Ω–µ—Å–µ–Ω –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Å –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å –æ–±–æ–±—â–µ–Ω–∏—è–º–∏:
```java
public class DAOBasicOperations<T> {  
    public void save(T obj) {  
      Session session = HibernateSessionFactoryUtil.getSessionFactory().openSession();  
	  Transaction tx1 = session.beginTransaction();  
	  session.save(obj);  
	  tx1.commit();  
	  session.close();  
  }  
  
    public void update(T obj) {  
      Session session = HibernateSessionFactoryUtil.getSessionFactory().openSession();  
	  Transaction tx1 = session.beginTransaction();  
	  session.update(obj);  
	  tx1.commit();  
	  session.close();  
  }  
  
    public void delete(T obj) {  
	  Session session = HibernateSessionFactoryUtil.getSessionFactory().openSession();  
	  Transaction tx1 = session.beginTransaction();  
	  session.delete(obj);  
	  tx1.commit();  
	  session.close();  
	}  
}
```
–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ:

_–õ–∏—Å—Ç–∏–Ω–≥ 3.1 MessageDAO_
```java
public class MessageDAO {  
      private DAOBasicOperations<Message> basicOperations = new DAOBasicOperations<>();  
	  Message findById(Long id) {  
	        return HibernateSessionFactoryUtil.getSessionFactory().openSession().get(Message.class, id);  
	  }  
  
	  void save(Message user) {  
	        basicOperations.save(user);  
	  }  
  
    void update(Message user) {  
	        basicOperations.update(user);  
    }  
  
    void delete(Message user) {  
	        basicOperations.delete(user);  
    }  
    List<Message> findAll() {  
        try (Session session = HibernateSessionFactoryUtil.getSessionFactory().openSession()){  
            return session.createQuery("from Message", Message.class).list();  
	    }  
    }  
}
```
## entity
|–°—É—â–Ω–æ—Å—Ç—å| –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|--|--|
|User| –î–∞–Ω–Ω—ã–µ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ |
| ContactDetails | –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ (email, vk id ...) |
|Chat| –ß–∞—Ç –æ—á–µ—Ä–µ–¥–∏ (one-to-one `Queue`) |
| Message | –°–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∞—Ç–µ (one-to-one `Chat`) |
|Queue| –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—á–µ—Ä–µ–¥–∏ |
| Session | –°–µ—Å—Å–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º (accessToken, refreshToken) |




